<div class="container-geral">
  <mat-card class="client-card">
    <mat-card-title class="titulo-formulario">
      <i class="material-icons">add_circle</i>
      NOVA FORMA DE PAGAMENTO
    </mat-card-title>

    <form class="client-form" #formPagamento="ngForm">
      
      <!-- TIPO DE PAGAMENTO -->
      <mat-form-field appearance="outline" class="full-width">
        <mat-label>Tipo de Pagamento *</mat-label>
        <mat-select [(ngModel)]="formaPagamento.fpgTipo" name="fpgTipo" required (selectionChange)="onTipoChange()">
          <mat-option value="Credito">
            <i class="material-icons">credit_card</i> Crédito
          </mat-option>
          <mat-option value="Debito">
            <i class="material-icons">payment</i> Débito
          </mat-option>
          <mat-option value="Dinheiro">
            <i class="material-icons">attach_money</i> Dinheiro
          </mat-option>
          <mat-option value="Pix">
            <i class="material-icons">qr_code</i> Pix
          </mat-option>
          <mat-option value="Boleto">
            <i class="material-icons">receipt</i> Boleto
          </mat-option>
        </mat-select>
        <mat-error *ngIf="!formaPagamento.fpgTipo">Tipo é obrigatório</mat-error>
      </mat-form-field>

      <!-- DESCRIÇÃO -->
      <mat-form-field appearance="outline" class="full-width">
        <mat-label>Descrição *</mat-label>
        <input matInput [(ngModel)]="formaPagamento.fpgDescricao" name="fpgDescricao" 
               placeholder="Ex: Pagamento via cartão de crédito" required>
        <mat-error *ngIf="!formaPagamento.fpgDescricao">Descrição é obrigatória</mat-error>
      </mat-form-field>

      <!-- CAMPOS DE PARCELAMENTO E TAXA PARA TODOS OS TIPOS -->
      
      <!-- PERMITE PARCELAMENTO -->
      <div class="radio-section">
        <label class="subtitle">Permite Parcelamento?</label>
        <div class="radio-buttons">
          <button type="button" class="radio-btn sim" 
                  [class.active]="formaPagamento.fpgPermiteParcelamento === 'S'"
                  (click)="formaPagamento.fpgPermiteParcelamento = 'S'; onParcelamentoChange()">
            <i class="material-icons">check_circle</i> Sim
          </button>
          <button type="button" class="radio-btn nao" 
                  [class.active]="formaPagamento.fpgPermiteParcelamento === 'N'"
                  (click)="onParcelamentoChange()">
            <i class="material-icons">cancel</i> Não
          </button>
        </div>
      </div>

      <!-- NÚMERO DE PARCELAS -->
      <mat-form-field appearance="outline" class="half-width" 
                     *ngIf="formaPagamento.fpgPermiteParcelamento === 'S'">
        <mat-label>Número Máximo de Parcelas</mat-label>
        <input matInput type="number" [(ngModel)]="formaPagamento.fpgNumMaxParcelas" 
               name="fpgNumMaxParcelas" min="1" max="24" placeholder="6">
        <mat-hint>Mín: 1, Máx: 24</mat-hint>
      </mat-form-field>

      <!-- TAXA ADICIONAL -->
      <mat-form-field appearance="outline" class="half-width">
        <mat-label>Taxa Adicional (%)</mat-label>
        <input matInput type="number" [(ngModel)]="formaPagamento.fpgTaxaAdicional" 
               name="fpgTaxaAdicional" min="0" max="100" step="0.01" placeholder="2.50">
        <mat-hint>Taxa em porcentagem (0 a 100)</mat-hint>
      </mat-form-field>

      <!-- BOTÕES -->
      <div class="button-container">
        <button mat-raised-button color="primary" (click)="salvar()" 
                [disabled]="!formaPagamento.fpgTipo || !formaPagamento.fpgDescricao">
          <i class="material-icons">save</i> Salvar
        </button>
        <button mat-raised-button color="warn" (click)="cancel()">
          <i class="material-icons">cancel</i> Cancelar
        </button>
        <button mat-raised-button color="accent" (click)="limpar()">
          <i class="material-icons">clear</i> Limpar
        </button>
      </div>
    </form>
  </mat-card>
</div>
